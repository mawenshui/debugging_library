# UI 原型与操作流（当前实现）

## 主界面

布局：

- 顶部栏：显示本机实例 ID、对端标识输入框、功能按钮
- 主区：左侧搜索结果列表，右侧详情
- 底部：状态栏显示导入/导出/保存提示

关键交互：

- 输入搜索词：自动触发检索（默认 Hybrid：优先 FTS5；若无结果回退到关键字包含匹配；空格分词后按 AND 组合）
- 未输入搜索词：按更新时间倒序分页展示全部条目（每页最多 100 条）
- 标签筛选：勾选标签后刷新列表；支持一键清空
- 职业筛选：全部/未标记/7 类职业；与搜索词、标签筛选叠加生效
- 下拉框交互：点击下拉框整行可展开/收起下拉菜单（不必精确点击右侧箭头）
- 分页：显示“第 N 页（共 M 条）”
- 本机实例ID：点击可复制到剪贴板（底部状态栏提示复制结果），便于多终端离线交换
- 选择结果：加载详情展示（现象/原因/方案/环境）
- 新建：打开编辑窗口，保存后写入本地库
- 编辑/删除：右侧详情区操作，删除为软删除
- 附件：支持添加附件；支持应用内预览（图片/文本类）；也可外部打开
- 日志：打开“日志”窗口查看本次启动以来的历史日志并实时追加
- 冲突：打开“冲突中心”窗口处理导入冲突（可读摘要 + 差异提示；保留本地/采用导入）
- 导入：选择 zip 包，导入后刷新列表（如有搜索词）
- 导出（增量/全量）：选择导出目录并生成 zip 包
- 批量导出：选择导出格式（Excel/CSV/JSONL）并按职业/标签/更新时间范围筛选后导出单文件
- 表单导入（Excel）：选择 .xlsx，配置字段映射并校验，确认后导入并可保存校验报告
- 设置：可设置当前用户名与职业/角色；职业会影响“问题编辑”中的环境字段模板
- 设置 → 职业设置：按职业配置默认固定字段（最多 8 个），保存后立即影响新建/编辑
- 设置 → 操作密码：设置本机操作密码（仅存哈希），用于高危操作校验
- 设置 → 批量删除问题（危险）：按职业/标签/更新时间范围筛选后物理删除（不可恢复），执行前必须校验操作密码
- 关于：查看产品信息（名称/版本/作者/运行时/系统）
- 窗口标题栏：全局自定义标题栏样式，支持拖拽/双击最大化/右键系统菜单/最小化最大化关闭；最大化不遮挡任务栏
- 当出现极端数据库锁冲突：弹窗提示“数据库忙，请稍后重试（已自动重试一次）”

代码入口：

- UI：[MainWindow.xaml](file:///d:/_TraeProject/debugging_library/src/FieldKb.Client.Wpf/MainWindow.xaml)
- VM：[MainViewModel.cs](file:///d:/_TraeProject/debugging_library/src/FieldKb.Client.Wpf/MainViewModel.cs)
- 对话框服务：[WpfDialogService.cs](file:///d:/_TraeProject/debugging_library/src/FieldKb.Client.Wpf/Services/WpfDialogService.cs)

## 已知限制（原型）

- 搜索摘要目前为简单截取，尚未实现更智能的摘要与多字段择优策略
- 附件预览当前仅覆盖图片/文本类文件
