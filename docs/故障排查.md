# 故障排查

## 构建失败

- 确认安装 .NET SDK 8.x：`dotnet --info`
- 清理后重试：删除各项目 `bin/obj`（或执行 `dotnet clean`）
- 如提示“文件被 FieldKb.Client.Wpf 锁定”：先退出正在运行的应用（或结束进程）再重新构建/测试

## 运行后无数据/无法搜索

- 检查数据库是否创建：
  - `<程序目录>\\data\\kb.sqlite`
- 首次运行会自动迁移；如迁移失败，建议删除 `kb.sqlite` 让应用重新创建
- 若界面无响应/操作失败，先打开“日志”窗口或查看日志文件：
  - `<程序目录>\\data\\logs\\FieldKb_yyyyMMdd_HHmmss.log`

## 弹窗提示“数据库忙”

- 场景：刚进行批量写操作（例如删除标签、导入/导出写入）后立即触发查询/新建，可能遇到 SQLite 短暂锁冲突
- 行为：应用会自动重试一次；若仍失败会弹窗提示“数据库忙”
- 处理：等待 1–2 秒后重试；如频繁出现，优先查看日志定位是否有长时间写入任务占用

## 导入失败（校验不通过）

- 包内文件被改动或传输损坏会导致 sha256 校验失败
- 重新从导出端生成包并再次传输

## 导入后数据未覆盖

- 当前合并策略是稳定的“最后写入优先（LWW）”
- 如果导入记录更旧，会被跳过并记入 conflictRecord
- 导入完成提示以“问题条数”为主；日志中会额外记录标签/关联/附件等实体分项与总计

## 搜索无结果但确定存在数据

- 默认检索策略为 Hybrid：优先走 SQLite FTS5（MATCH），若无结果自动回退到“包含匹配”
- 输入 `A B`：包含匹配回退策略下为“空格分词 AND”，需要同时包含 A 与 B
- 不输入搜索词会按更新时间倒序分页展示全部条目（每页 100 条），可通过“下一页”继续查看
